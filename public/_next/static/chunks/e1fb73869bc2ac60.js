(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,34221,e=>{"use strict";var t=e.i(56135),a=e.i(91543),s=e.i(58129);let r="/api/v1";function l(){let{token:e}=(0,s.useAuth)(),[l,n]=(0,a.useState)([]),[i,d]=(0,a.useState)(!1),[o,c]=(0,a.useState)(0),u=(0,a.useRef)(null),h=async()=>{if(e)try{let t=await fetch(`${r}/notifications`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json();n(e),c(e.filter(e=>!e.is_read).length)}}catch(e){console.error(e)}};(0,a.useEffect)(()=>{h();let e=setInterval(h,1e4);return()=>clearInterval(e)},[e]),(0,a.useEffect)(()=>{let e=e=>{u.current&&!u.current.contains(e.target)&&d(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let m=async t=>{try{await fetch(`${r}/notifications/${t}/read`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`}}),n(e=>e.map(e=>e.id===t?{...e,is_read:!0}:e)),c(e=>Math.max(0,e-1))}catch(e){}},x=async()=>{try{await fetch(`${r}/notifications/read-all`,{method:"PATCH",headers:{Authorization:`Bearer ${e}`}}),n(e=>e.map(e=>({...e,is_read:!0}))),c(0)}catch(e){}},g=async(t,a)=>{t.stopPropagation();try{(await fetch(`${r}/notifications/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}})).ok&&n(e=>{let t=e.find(e=>e.id===a),s=e.filter(e=>e.id!==a);return t&&!t.is_read&&c(e=>Math.max(0,e-1)),s})}catch(e){console.error("Lá»—i xÃ³a thÃ´ng bÃ¡o",e)}};return(0,t.jsxs)("div",{className:"relative",ref:u,children:[(0,t.jsxs)("button",{onClick:()=>d(!i),className:"relative p-2 rounded-full hover:bg-gray-100 transition-colors",children:[(0,t.jsx)("span",{className:"text-xl",children:"ðŸ””"}),o>0&&(0,t.jsx)("span",{className:"absolute top-0 right-0 w-4 h-4 bg-red-500 text-white text-[10px] font-bold flex items-center justify-center rounded-full border border-white",children:o>9?"9+":o})]}),i&&(0,t.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-xl shadow-2xl border border-gray-200 z-50 animate-fade-in overflow-hidden origin-top-right",children:[(0,t.jsxs)("div",{className:"p-3 border-b border-gray-100 flex justify-between items-center bg-gray-50",children:[(0,t.jsx)("h3",{className:"font-bold text-sm text-gray-700",children:"ThÃ´ng bÃ¡o"}),o>0&&(0,t.jsx)("button",{onClick:x,className:"text-xs text-indigo-600 hover:underline font-medium",children:"Äá»c táº¥t cáº£"})]}),(0,t.jsx)("div",{className:"max-h-80 overflow-y-auto custom-scrollbar",children:0===l.length?(0,t.jsx)("div",{className:"p-8 text-center text-gray-400 text-xs",children:"KhÃ´ng cÃ³ thÃ´ng bÃ¡o má»›i"}):l.map(e=>{let a;return(0,t.jsxs)("div",{onClick:()=>!e.is_read&&m(e.id),className:`p-3 border-b border-gray-50 cursor-pointer transition-colors relative group ${e.is_read?"bg-white opacity-60 hover:bg-gray-50":"bg-blue-50/40 hover:bg-blue-50"}`,children:[(0,t.jsx)("button",{onClick:t=>g(t,e.id),className:"absolute top-2 right-2 w-5 h-5 flex items-center justify-center rounded-full text-gray-400 hover:bg-red-100 hover:text-red-600 opacity-0 group-hover:opacity-100 transition-all z-10",title:"XÃ³a thÃ´ng bÃ¡o",children:"Ã—"}),(0,t.jsxs)("div",{className:"flex justify-between items-start mb-1 pr-5",children:[(0,t.jsx)("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded uppercase tracking-wider ${"OVERDUE"===e.type?"bg-red-100 text-red-600":"ASSIGN"===e.type?"bg-green-100 text-green-600":"bg-gray-100 text-gray-600"}`,children:e.type}),(0,t.jsx)("span",{className:"text-[10px] text-gray-400",children:(a=new Date(e.created_at),`${a.getHours()}:${a.getMinutes()} - ${a.getDate()}/${a.getMonth()+1}`)})]}),(0,t.jsx)("p",{className:`text-sm text-gray-800 mb-0.5 ${!e.is_read?"font-semibold":""}`,children:e.title}),(0,t.jsx)("p",{className:"text-xs text-gray-500 line-clamp-2 leading-snug",children:e.message})]},e.id)})})]})]})}e.s(["default",()=>l])},88776,e=>{"use strict";var t=e.i(56135);function a({name:e,size:a="md"}){let s=e?e.charAt(0).toUpperCase():"?",r=["bg-red-500","bg-orange-500","bg-amber-500","bg-green-500","bg-emerald-500","bg-teal-500","bg-cyan-500","bg-blue-500","bg-indigo-500","bg-violet-500","bg-purple-500","bg-fuchsia-500","bg-pink-500","bg-rose-500"],l=0;for(let t=0;t<(e||"").length;t++)l=e.charCodeAt(t)+((l<<5)-l);let n=r[Math.abs(l)%r.length];return(0,t.jsx)("div",{className:`${{sm:"w-6 h-6 text-xs",md:"w-8 h-8 text-sm",lg:"w-10 h-10 text-base",xl:"w-12 h-12 text-lg"}[a]} ${n} rounded-full flex items-center justify-center text-white font-bold shadow-sm border-2 border-white`,children:s})}e.s(["default",()=>a])},54361,e=>{"use strict";var t=e.i(56135);function a({isOpen:e,title:a,message:s,onConfirm:r,onCancel:l,isLoading:n}){return e?(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 animate-fade-in",children:(0,t.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md p-6 mx-4 transform transition-all scale-100",children:[(0,t.jsx)("div",{className:"flex items-center gap-3 text-red-600 mb-4",children:(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:a})}),(0,t.jsx)("p",{className:"text-gray-500 mb-6 text-sm leading-relaxed",children:s}),(0,t.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,t.jsx)("button",{onClick:l,disabled:n,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:"Há»§y bá»"}),(0,t.jsx)("button",{onClick:r,disabled:n,className:"px-4 py-2 text-sm font-medium text-white bg-red-600 rounded-lg hover:bg-red-700 flex items-center gap-2",children:n?"Äang xá»­ lÃ½...":"XÃ³a ngay"})]})]})}):null}e.s(["default",()=>a])},64436,e=>{"use strict";var t=e.i(56135);function a({type:e,value:a}){let s={TODO:"bg-gray-100 text-gray-600 border-gray-200",IN_PROGRESS:"bg-blue-50 text-blue-600 border-blue-200",REVIEW:"bg-purple-50 text-purple-600 border-purple-200",DONE:"bg-green-50 text-green-600 border-green-200",COMPLETED:"bg-green-50 text-green-600 border-green-200",OVERDUE:"bg-red-50 text-red-600 border-red-200",LOW:"bg-slate-100 text-slate-600",MEDIUM:"bg-yellow-50 text-yellow-600",HIGH:"bg-orange-50 text-orange-600",URGENT:"bg-red-50 text-red-600",ADMIN:"bg-red-100 text-red-700 border-red-200",PM:"bg-indigo-100 text-indigo-700 border-indigo-200",MEMBER:"bg-gray-100 text-gray-700 border-gray-200"}[a]||"bg-gray-100 text-gray-600 border-gray-200";return(0,t.jsx)("span",{className:`px-2.5 py-0.5 rounded-full text-[11px] font-bold border uppercase tracking-wide ${s}`,children:a?.replace("_"," ")})}e.s(["default",()=>a])},69240,e=>{e.v({container:"styles-module__BBDXrq__container",createBtn:"styles-module__BBDXrq__createBtn",deleteBtn:"styles-module__BBDXrq__deleteBtn",editBtn:"styles-module__BBDXrq__editBtn",filterSelect:"styles-module__BBDXrq__filterSelect",headerWrapper:"styles-module__BBDXrq__headerWrapper",pageBtn:"styles-module__BBDXrq__pageBtn",paginationBar:"styles-module__BBDXrq__paginationBar",searchContainer:"styles-module__BBDXrq__searchContainer",searchIcon:"styles-module__BBDXrq__searchIcon",searchInput:"styles-module__BBDXrq__searchInput",subtitle:"styles-module__BBDXrq__subtitle",tableContainer:"styles-module__BBDXrq__tableContainer",tableHead:"styles-module__BBDXrq__tableHead",td:"styles-module__BBDXrq__td",tdCenter:"styles-module__BBDXrq__tdCenter",tdRight:"styles-module__BBDXrq__tdRight",th:"styles-module__BBDXrq__th",thCenter:"styles-module__BBDXrq__thCenter",thRight:"styles-module__BBDXrq__thRight",title:"styles-module__BBDXrq__title",toolbar:"styles-module__BBDXrq__toolbar",tr:"styles-module__BBDXrq__tr",userEmail:"styles-module__BBDXrq__userEmail",userInfo:"styles-module__BBDXrq__userInfo",userName:"styles-module__BBDXrq__userName"})},74764,e=>{"use strict";var t=e.i(56135),a=e.i(91543),s=e.i(58129),r=e.i(96504),l=e.i(88776),n=e.i(64436),i=e.i(87402),d=e.i(54361),o=e.i(34221),c=e.i(69240);let u="/api/v1";function h(){let{user:e,token:h}=(0,s.useAuth)(),m=(0,r.useRouter)(),[x,g]=(0,a.useState)([]),[b,f]=(0,a.useState)({page:1,total_pages:1,total_records:0}),[p,_]=(0,a.useState)(!0),[y,j]=(0,a.useState)(""),[v,N]=(0,a.useState)(""),[B,w]=(0,a.useState)(1),[D,E]=(0,a.useState)(!1),[C,M]=(0,a.useState)(null),[$,I]=(0,a.useState)({username:"",email:"",password:"",role:"MEMBER"}),[X,k]=(0,a.useState)({isOpen:!1,userId:null,username:""}),[q,S]=(0,a.useState)(!1),T=async(e="",t=1,a="")=>{if(h){_(!0);try{let s=await fetch(`${u}/users?page=${t}&limit=10&search=${e}&role=${a}`,{headers:{Authorization:`Bearer ${h}`}}),r=await s.json();s.ok?(g(r.data||[]),f(r.pagination||{page:1,total_pages:1,total_records:0})):i.default.error(r.message)}catch(e){i.default.error("Lá»—i káº¿t ná»‘i server")}finally{_(!1)}}};(0,a.useEffect)(()=>{e&&"ADMIN"!==e.role&&m.push("/dashboard")},[e,m]),(0,a.useEffect)(()=>{if(h){let e=setTimeout(()=>T(y,B,v),500);return()=>clearTimeout(e)}},[h,y,B,v]);let R=async e=>{e.preventDefault();let t=C?`${u}/users/${C.id}`:`${u}/users`,a=C?"PATCH":"POST",s={...$};C&&!s.password&&delete s.password;try{let e=await fetch(t,{method:a,headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`},body:JSON.stringify(s)});e.ok?(E(!1),M(null),I({username:"",email:"",password:"",role:"MEMBER"}),T(y,B,v),i.default.success(C?"Cáº­p nháº­t thÃ nh cÃ´ng!":"Táº¡o thÃ nh cÃ´ng!")):i.default.error((await e.json()).message)}catch(e){i.default.error("Lá»—i káº¿t ná»‘i")}},A=async()=>{if(X.userId){S(!0);try{(await fetch(`${u}/users/${X.userId}`,{method:"DELETE",headers:{Authorization:`Bearer ${h}`}})).ok?(i.default.success("ÄÃ£ xÃ³a"),T(y,B,v),k({isOpen:!1,userId:null,username:""})):i.default.error("KhÃ´ng thá»ƒ xÃ³a")}catch(e){i.default.error("Lá»—i xÃ³a")}finally{S(!1)}}};return p?(0,t.jsx)("div",{className:"p-8 text-center",children:"Äang táº£i dá»¯ liá»‡u..."}):(0,t.jsxs)("div",{className:c.default.container,children:[(0,t.jsxs)("div",{className:c.default.headerWrapper,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:c.default.title,children:"ThÃ nh viÃªn há»‡ thá»‘ng"}),(0,t.jsxs)("p",{className:c.default.subtitle,children:["Quáº£n lÃ½ ",b.total_records," tÃ i khoáº£n nhÃ¢n viÃªn."]})]}),(0,t.jsxs)("div",{className:c.default.toolbar,children:[(0,t.jsx)("div",{className:"mr-2 flex items-center",children:(0,t.jsx)(o.default,{})}),(0,t.jsxs)("div",{className:c.default.searchContainer,children:[(0,t.jsx)("input",{type:"text",placeholder:"TÃ¬m tÃªn...",className:c.default.searchInput,value:y,onChange:e=>{j(e.target.value),w(1)}}),(0,t.jsx)("span",{className:c.default.searchIcon,children:"ðŸ”"})]}),(0,t.jsxs)("select",{className:c.default.filterSelect,value:v,onChange:e=>{N(e.target.value),w(1)},children:[(0,t.jsx)("option",{value:"",children:"Táº¥t cáº£ vai trÃ²"}),(0,t.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,t.jsx)("option",{value:"PM",children:"PM"}),(0,t.jsx)("option",{value:"MEMBER",children:"Member"})]}),(0,t.jsx)("button",{onClick:()=>{M(null),I({username:"",email:"",password:"",role:"MEMBER"}),E(!0)},className:c.default.createBtn,children:"+ ThÃªm má»›i"})]})]}),(0,t.jsxs)("div",{className:c.default.tableContainer,children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,t.jsx)("thead",{className:c.default.tableHead,children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:c.default.th,children:"ThÃ nh viÃªn"}),(0,t.jsx)("th",{className:c.default.th,children:"Email"}),(0,t.jsx)("th",{className:c.default.thCenter,children:"Vai trÃ²"}),(0,t.jsx)("th",{className:c.default.thRight,children:"Tham gia"}),(0,t.jsx)("th",{className:c.default.thRight,children:"Thao tÃ¡c"})]})}),(0,t.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:x.length>0?x.map(e=>(0,t.jsxs)("tr",{className:`${c.default.tr} group`,children:[(0,t.jsx)("td",{className:c.default.td,children:(0,t.jsxs)("div",{className:c.default.userInfo,children:[(0,t.jsx)(l.default,{name:e.username,size:"md"}),(0,t.jsx)("div",{className:"ml-4",children:(0,t.jsx)("div",{className:c.default.userName,children:e.username})})]})}),(0,t.jsx)("td",{className:c.default.td,children:(0,t.jsx)("div",{className:c.default.userEmail,children:e.email})}),(0,t.jsx)("td",{className:c.default.tdCenter,children:(0,t.jsx)(n.default,{value:e.role})}),(0,t.jsx)("td",{className:c.default.tdRight,children:new Date(e.created_at).toLocaleDateString("vi-VN")}),(0,t.jsxs)("td",{className:c.default.tdRight,children:[(0,t.jsx)("button",{onClick:()=>{M(e),I({username:e.username,email:e.email,password:"",role:e.role}),E(!0)},className:c.default.editBtn,children:"Sá»­a"}),(0,t.jsx)("button",{onClick:()=>{k({isOpen:!0,userId:e.id,username:e.username})},className:c.default.deleteBtn,children:"XÃ³a"})]})]},e.id)):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:"5",className:"text-center py-8 text-gray-500",children:"KhÃ´ng tÃ¬m tháº¥y káº¿t quáº£."})})})]})}),(0,t.jsxs)("div",{className:c.default.paginationBar,children:[(0,t.jsxs)("div",{className:"text-xs text-gray-500",children:["Trang ",(0,t.jsx)("strong",{children:b.page})," / ",b.total_pages]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)("button",{onClick:()=>w(e=>Math.max(e-1,1)),disabled:1===B,className:c.default.pageBtn,children:"TrÆ°á»›c"}),(0,t.jsx)("button",{onClick:()=>w(e=>Math.min(e+1,b.total_pages)),disabled:B>=b.total_pages,className:c.default.pageBtn,children:"Sau"})]})]})]}),D&&(0,t.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 animate-fade-in",children:(0,t.jsxs)("div",{className:"bg-white p-6 rounded-xl shadow-xl w-96 border border-gray-200",children:[(0,t.jsx)("h2",{className:"text-lg font-bold mb-4 text-gray-800",children:C?"Sá»­a thÃ´ng tin":"ThÃªm thÃ nh viÃªn má»›i"}),(0,t.jsxs)("form",{onSubmit:R,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:c.default.inputLabel,children:"Username"}),(0,t.jsx)("input",{className:c.default.searchInput,value:$.username,onChange:e=>I({...$,username:e.target.value}),required:!0})]}),!C&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:c.default.inputLabel,children:"Email"}),(0,t.jsx)("input",{type:"email",className:c.default.searchInput,value:$.email,onChange:e=>I({...$,email:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:c.default.inputLabel,children:"Role"}),(0,t.jsxs)("select",{className:c.default.searchInput,value:$.role,onChange:e=>I({...$,role:e.target.value}),children:[(0,t.jsx)("option",{value:"MEMBER",children:"MEMBER"}),(0,t.jsx)("option",{value:"PM",children:"PM"}),(0,t.jsx)("option",{value:"ADMIN",children:"ADMIN"})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:c.default.inputLabel,children:C?"Äá»•i máº­t kháº©u (tÃ¹y chá»n)":"Máº­t kháº©u"}),(0,t.jsx)("input",{type:"password",className:c.default.searchInput,value:$.password,onChange:e=>I({...$,password:e.target.value}),required:!C})]}),(0,t.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,t.jsx)("button",{type:"button",onClick:()=>E(!1),className:c.default.pageBtn,children:"Há»§y"}),(0,t.jsx)("button",{type:"submit",className:c.default.createBtn,children:"LÆ°u"})]})]})]})}),(0,t.jsx)(d.default,{isOpen:X.isOpen,title:"XÃ³a tÃ i khoáº£n?",message:`X\xf3a t\xe0i khoáº£n "${X.username}"? Kh\xf4ng thá»ƒ ho\xe0n t\xe1c.`,onConfirm:A,onCancel:()=>k({isOpen:!1,userId:null,username:""}),isLoading:q})]})}e.s(["default",()=>h])}]);